---

    title: How to generate a certificate for Trusted File
    linkTitle: Generate a certificate
    weight: 240

---
## How to generate a certificate with XCA

To generate certificates, for example using the XCA utility (X Certificate and Key management), perform the following steps.

1. Create a <span class="bold_in_para">****New database****</span>.

    -   Enter a password to protect the database that contains your certificate.

    ![Certificate and key management screen shot](/Images/TransferCFT/XCA_db_tab.png)

1. Select the <span class="bold_in_para">****Certificates**** </span>tab.
    -   Select: <span class="bold_in_para">****New Certificate****</span>

1. Select the <span class="bold_in_para">****Source**** </span>tab.
    -   In the <span class="bold_in_para">****Signature algorithm****</span> field, select <span class="bold_in_para">****MD5****</span>.

1. Select the <span class="bold_in_para">****Subject**** </span>tab.
    -   Complete the fields for your certificate.

    <!-- -->

    -   Click <span class="bold_in_para">****Generate a new key****</span>.
        -   Enter a key name
        -   Select 1024 bit as the key size
        -   Select Keytype
        -   Click <span class="bold_in_para">****Create****</span>

1. In the <span class="bold_in_para">****Extensions**** </span>tab:

    -   In "Type": select End Entity

    <!-- -->

    -   Select "Subject Key Identifier"

    <!-- -->

    -   Select the expiry date of your certificates

    <!-- -->

    -   Inform: "Subject alternative Name"

    ![Create certificate screen with selected Extension tab](/Images/TransferCFT/XCA_tab.png)

1. In the <span class="bold_in_para">****Key Usage****</span> tab:
    -   In "Key Usage", select :
        -   Digital Signature

        <!-- -->

        -   Non Repudiation

        <!-- -->

        -   Key Enciphering

        <!-- -->

        -   Data Enciphering

    <!-- -->

    -   In "Extended Key usage", select:
        -   E-mail Protection

1. Click  <span class="bold_in_para">****OK**** </span>to generate the certificate.

## Export the certificate that has been created.

1. In <span class="bold_in_para">****Certificates**** </span>tab, select the certificate you want to export.
1. Select Export.
    -   In Export Format: choose "PEM" for export PUBLIC CERTIFICATE.

    <!-- -->

    -   Click <span class="bold_in_para">****OK**** </span>.

    <!-- -->

    -   Select Export.
1. Select the certificate you want to export (filename).
    -   In Export Format: choose "PKCS #12" for export PRIVATE CERTIFICATE
    -   Click <span class="bold_in_para">****OK**** </span>.
1. Enter a password to protect your private certificates.

## How to generate a certificate with OpenSSL

To create a self signed certificate:

```
openssl req -new -newkey rsa:4096 -x509 -sha256 -days 365 -nodes -out XPP_Sample_User1.pem -keyout MyKey.key
```

Export the certificate in PKCS12 format:

```
openssl pkcs12 -export -out XPP_Sample_User1.p12 -inkey MyKey.key -in XPP_Sample_User1.pem
```

## Use the CFTTF utility to generate your passphrase

Use the CFTTF utility, to perform the following task.

Enter: <span class="code">`CFTTF –pw [XXXX]`</span>

Where: XXXX --> is the same password as your private "PKCS #12" certificates (see above steps).

****Example****

`CFTTF –pw Axway`

`OUTPUT:   m8ZWaOMdkj70UzJZD+wv8gSsi1ycSTEJ5c0H6SH6dLE=`

## Update the entity.xml file

In  the delivered entity.xml file, update the location in the user1\_pub entity. For example, if <span class="code">`XPP_Sample_User1.pem`</span> is in the <span class="code">`/home/cft/runtime/conf/tf/certs/pub`</span> folder, then:

```
<pkiEntity id="user1_pub">
<certificate>
<format>PEM</format>
<location>/home/cft/runtime/conf/tf/certs/priv/XPP_Sample_User1.p12</location>
</certificate>
</pkiEntity>
```

In  the delivered entity.xml file, update the location in the user1\_pub entity. For example, if <span class="code">`XPP_Sample_User1.p12`</span> is in the <span class="code">`/home/cft/runtime/conf/tf/certs/priv`</span> folder and the password=Axway, then:

```
<pkiEntity id="user1_priv">
<certificate>
<format>PKCS#12</format>
<location>/home/cft/runtime/conf/tf/certs/privXPP_Sample_User1.p12</location>
<passPhrase>m8ZWaOMdkj70UzJZD+wv8gSsi1ycSTEJ5c0H6SH6dLE=</passPhrase>
</certificate>
</pkiEntity>
```

## Update your Trusted File encoding/decoding procedures

You must change the passphrase that corresponds to the private key passphrase generated by CFTTF command ( CFTTF -pw xxxx) in either the <span class="code">`conf/tf/decfile_cms.xml`</span> or <span class="code">`conf/tf/encfile_cms.xml`</span> file.

In the examples on this page, we changed the public and private keys for the <span class="code">`user1_pub`</span> and `user1_priv_entity` (the PKCS12 certificate and key, using the password Axway), where the corresponding example passphrase is `m8ZWaOMdkj70UzJZD+wv8gSsi1ycSTEJ5c0H6SH6dLE=.`

As the private key `user1_priv` is referenced in` enfile_cms.xms` file , you must change the passphrase in the <span class="code">`<signature>`</span> section as follows:

```
<signature requested="yes">
<signer>
<signatureAlgorithm>sha1WithRsaEncryption</signatureAlgorithm>
<pkiEntity id="user1_priv" password="m8ZWaOMdkj70UzJZD+wv8gSsi1ycSTEJ5c0H6SH6dLE="></pkiEntity>
</signer>
</signature>
```
